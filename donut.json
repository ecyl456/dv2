{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 350,
    "height": 200,
    "description": "A donut chart with the most recent year's data.",
    "layer": [
        {
            "data": {
                "url": "https://raw.githubusercontent.com/ecyl456/dv2/refs/heads/main/datasets/gross-national-income-per-capita-undp.csv"
            },
            "transform": [
                {
                    "filter": "datum.Year == 2022"
                },
                {
                    "calculate": "toNumber(datum['Gross national income per capita'])",
                    "as": "GNI_per_capita"
                },
                {
                    "filter": "isValid(datum.GNI_per_capita) && !isNaN(datum.GNI_per_capita)"
                },
                {
                    "window": [
                        {
                            "op": "rank",
                            "as": "rank"
                        }
                    ],
                    "sort": [
                        {
                            "field": "GNI_per_capita",
                            "order": "descending"
                        }
                    ]
                },
                {
                    "filter": "datum.rank <= 10"
                }
            ],
            "mark": {
                "type": "arc",
                "innerRadius": 50
            },
            "encoding": {
                "theta": {
                    "field": "GNI_per_capita",
                    "type": "quantitative"
                },
                "color": {
                    "field": "Entity",
                    "type": "nominal",
                    "scale": {
                        "range": [
                            "#A89ACD",
                            "#80D6EB",
                            "#967BB6",
                            "#F7B4A2",
                            "#70A9A1",
                            "#b2edb7",
                            "#607580",
                            "#a3bae7",
                            "#60819c",
                            "#fab9cc"
                        ]
                    }
                },
                "tooltip": [
                    {
                        "field": "Entity",
                        "type": "nominal"
                    },
                    {
                        "field": "Year",
                        "title": "Year",
                        "type": "ordinal"
                    },
                    {
                        "field": "GNI_per_capita",
                        "title": "Gross National Income Per Capita",
                        "type": "quantitative",
                        "format": ",d"
                    }
                ]
            }
        },
        {
            "data": {
                "url": "https://raw.githubusercontent.com/ecyl456/dv2/refs/heads/main/datasets/gross-national-income-per-capita-undp.csv"
            },
            "mark": "text",
            "encoding": {
                "text": {
                    "value": "Highest GNI Country"
                },
                "color": {
                    "value": "darkblue"
                },
                "x": {
                    "value": 335
                },
                "y": {
                    "value": 115
                }
            }
        },
        {
            "data": {
                "url": "https://raw.githubusercontent.com/ecyl456/dv2/refs/heads/main/datasets/gross-national-income-per-capita-undp.csv"
            },
            "mark": "circle",
            "encoding": {
                "color": {
                    "value": "darkblue"
                },
                "x": {
                    "value": 250
                },
                "y": {
                    "value": 115
                }
            }
        }
    ],
    "config": {
        "view": {
            "stroke": "transparent"
        },
        "legend": {
            "orient": "right",
            "padding": 30
        },
        "padding": {
            "top": 20,
            "left": 100,
            "bottom": 40
        }
    }
}